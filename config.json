{
    "metadata": {
        "title": "CMAQ Universal Kriging Configuration",
        "author": "Barron H. Henderson",
        "contact": "<lastname>.<firstname>@epa.gov",
        "Revision": "v0.2",
        "Notes" : "This has currently been tested for a single day of PM25 (20160115) and a single day of O3 MDA8 (20160715).",
        "field_definitions": {
            "transform": "Choose: none, log, or sqrt; these transform CMAQ and obs before regression/kriging",
            "thin_krig_dataset": "Useful for testing regression methods becuase kriging is usually the slowest part."
            "krig_opts.variogram_model": "pykrige variogram model (exponential or gaussian)",
            "krig_opts.variogram_parameters": "range is set by other parameters, but psill and nuggest are set here",
            "query_definitions": "definitions used to filter AQS sites/observatiosn can rely on latitude, longitude, population_density (#/km2), and any standard AQS field",
            "longitude_center": "Dividing line for West/East; units: degrees east",
            "latitude_center": "Dividing line for South/North; units: degrees north",
            "urban_minimum_density": "grid cells with people/km**2 less than urban_minimum density are rural",
            "urban_blend": "variable used ('var') to calculate fractional use of urban kriged surface where 0 is at value ('0') and 1 is at value ('1').",
            "east_blend": "Same as urban_blend, but for east.",
            "north_blend": "Same as urban_blend, but for north.",
            "query_gridcell_ranges": "range for sill and nugget to match definitions",
            "obs_path": "Path where observatiosn can be found.",
            "obs_defn": "first_max_value * 1000",
            "obs_key": "short name for observations.",
            "model_template": "strftime with for using date to constructe file path",
            "model_inkey": "Modeling variable name",
            "pop_path": "Population density file (must have DENS variable).",
            "griddesc_path": "Path to IOAPI GRIDDESC file",
            "gridcro2d_path" "Path for elevation, must be named HT"
            "domain": "Domain key (e.g., 12US1, 12US2, 36US3), which must be defined in griddesc_path",
            "regression_options.model": "sklearn_RandomForestRegressor or sklearn_LinearRegression or scipy_linregress",
            "regression_options.xkeys": "independent variables (predictors) currently has access to latitude, longitude, pop_per_km2, and xQ (x indicating transformed)",
            "regression_options.ykey": "dependent variable (predicted) usually transformed observation (i.e., xO)",
            "regression_options.model_options": "specific to the model you've choosen (see sklearn for more details)",
            "output_template": "path for outputs, typically output/UK.%Y%m%d.{querykey}.nc",
        }
    },
    "transform": "log",
    "thin_krig_dataset": 2,
    "krig_opts": {
        "variogram_model": "exponential",
        "pseudo_inv": true
    },
    "longitude_center": -97,
    "latitude_center": 40,
    "urban_minimum_density": 100,
    "urban_blend": {
        "var": "DENS", "0": 60, "1": 200, "notes": "15/km2 = 0; 100/km2 = 1"
    },
    "longitude_blend": {
        "var": "longitude", "0": -102, "1": -92, "notes": "5 degree transition on each side"
    },
    "latitude_blend": {
        "var": "latitude", "0": 35, "1": 45, "notes": "5 degree transition on each side"
    },
    "obs_path": "input/daily_88101_20160115.zip",
    "obs_defn": "arithmetic_mean",
    "obs_key": "O",
    "model_template": "/work/ROMO/2016platform/CMAQv531/2016fh/12US2/POST/dailyavg/dailyavg.LST.Y_24.2016fh.v531.12US2.%m.ncf",
    "model_inkey": "PM25_FRM",
    "pop_path": "/work/ROMO/gis_rasters/gpw-v4/gpw_v4_une_atotpopbt_densy_12US2.IOAPI.nc",
    "gridcro2d_path": "/home/bhenders/TestData/MCIP/GRIDCRO2D.12US2.35L.160101",
    "griddesc_path": "input/GRIDDESC",
    "domain": "12US2",
    "regression_options": {
        "model": "scipy_linregress (single independent) or sklearn_RandomForestRegressor or sklearn_LinearRegression",
        "xkeys": ["longitude", "latitude", "elevation", "pop_per_km2", "xQ"],
        "ykey": "xO",
        "model_options": {"n_estimators": 10, "max_depth": 3, "random_state": 1}
    },
    "output_template": "output/UK.%Y%m%d.{querykey}.{suffix}.nc",
    "query_definitions": {
        "WN_RUR": "longitude < {longitude_center} and latitude >= {latitude_center} and pop_per_km2 < {urban_minimum_density}",
        "WN_URB": "longitude < {longitude_center} and latitude >= {latitude_center} and pop_per_km2 >= {urban_minimum_density}",
        "WS_RUR": "longitude < {longitude_center} and latitude < {latitude_center} and pop_per_km2 < {urban_minimum_density}",
        "WS_URB": "longitude < {longitude_center} and latitude < {latitude_center} and pop_per_km2 >= {urban_minimum_density}",
        "EN_RUR": "longitude >= {longitude_center} and latitude >= {latitude_center} and pop_per_km2 < {urban_minimum_density}",
        "EN_URB": "longitude >= {longitude_center} and latitude >= {latitude_center} and pop_per_km2 >= {urban_minimum_density}",
        "ES_RUR": "longitude >= {longitude_center} and latitude < {latitude_center} and pop_per_km2 < {urban_minimum_density}",
        "ES_URB": "longitude >= {longitude_center} and latitude < {latitude_center} and pop_per_km2 >= {urban_minimum_density}",
        "WN_BOTH": "longitude < {longitude_center} and latitude >= {latitude_center}",
        "WS_BOTH": "longitude < {longitude_center} and latitude < {latitude_center}",
        "EN_BOTH": "longitude >= {longitude_center} and latitude >= {latitude_center}",
        "ES_BOTH": "longitude >= {longitude_center} and latitude < {latitude_center}",
        "ALL_URB": "pop_per_km2 >= {urban_minimum_density}",
        "ALL_RUR": "pop_per_km2 < {urban_minimum_density}",
        "ALL_BOTH": "longitude == longitude"
    }
}
    
